# This is a GUI for a web scraper that pulls PTR (Periodic Trading Records) from whoever I choose.

import tkinter as tk
from tkinter import ttk 
from tkinter import messagebox
import subprocess
import os
import customtkinter
import downloadFile2020 as df20
import downloadFile2021 as df21
import downloadFile2022 as df22
import downloadFile2023 as df23
import house as ho
from house import read_house
import pandas as pd

#
customtkinter.set_appearance_mode('System')
customtkinter.set_default_color_theme('blue')

# window
app = customtkinter.CTk()
app.geometry('720x480')
app.title('Congress Web Scraper')


# funciton for year input (excited as i figured this out myself :)
def startdownload():
    try:
        year = year_input.get()
        filename = "downloadFile{}.py".format(year)
        subprocess.call(["python", filename])
        #success
        finishLabel.configure(text='Your files are ready!', text_color='green')
    except:
        #error
        finishLabel.configure(text='There has been an Error!', text_color='red')
    
   



#function for searching the ptr (house)
def houseparse():
    try:
        year = year_input.get()
        lastname = last_name_var.get()
        textfilename = "{}FD.txt".format(year)
        subprocess.call(["python", 'house.py', textfilename, lastname])

        
        #output_label.configure(text='DocId')
        
    except subprocess.CalledProcessError as e:
        print("Error:", e)

        #success popup
        #messagebox.showinfo("Success", "Success")
        #---------------



#title
title = customtkinter.CTkLabel(app, text='Congress PTR Web Scraper!')
title.pack(padx=10, pady=25)

#year text
year_title = customtkinter.CTkLabel(app, text='Insert a year')
year_title.pack(padx=10, pady=10)

#input for the year
year_var = tk.StringVar()
year_input = customtkinter.CTkEntry(app, width=300, height=40, textvariable=year_var)
year_input.pack()

# download button
download = customtkinter.CTkButton(app, text="Download", command=startdownload)
download.pack(padx=10, pady=10)

#year text
last_name_title = customtkinter.CTkLabel(app, text='Insert a last name')
last_name_title.pack(padx=10, pady=10)

#input for the last name
last_name_var = tk.StringVar()
last_name_input = customtkinter.CTkEntry(app, width=300, height=40, textvariable=last_name_var)
last_name_input.pack()

# find button
find = customtkinter.CTkButton(app, text="Find", command=houseparse)
find.pack(padx=10, pady=10)


# Finished Downloading
finishLabel = customtkinter.CTkLabel(app, text='')
finishLabel.pack()

output_label = customtkinter.CTkLabel(app, text='')
output_label.pack()

# run loop
app.mainloop()

